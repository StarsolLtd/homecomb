{% extends "base.html.twig" %}

{% block title %}{{ locale.name }} | Lettings Agent Reviews | {{ site_name }}{% endblock %}

{% block headJavascripts %}
    <script src="https://www.google.com/recaptcha/api.js?render={{ google_recaptcha_site_key }}"></script>
{% endblock %}

{% block content %}
    <script>
        window.localeSlug = '{{ locale.slug }}';
    </script>
    <div class="container">

        <div class="col-md-12 page-title">
            <h1>{{ locale.name }}</h1>
        </div>

        <div class="bg-white rounded shadow-sm p-4 mb-4">

            <div class="row">
                {% include 'locale/content/' ~ locale.slug ~ '.html.twig' ignore missing  %}

                <div class="col-md-6 top-rated-agencies">
                    <h5 class="mb-1">Top rated agencies for lettings in {{ locale.name }}</h5>

                    {% for summary in agencyReviewsSummary.agencyReviewSummaries %}
                        <div class="agency clearfix">
                            <div class="float-left agency-logo-container">
                                {% if summary.agencyLogoImageFilename %}
                                    <a href="{{ path('agency-view-by-slug', {slug: summary.agencySlug}) }}">
                                        <img src="/images/images/{{ summary.agencyLogoImageFilename }}" class="agency-logo float-left" alt="{{ summary.agencyName }} Logo">
                                    </a>
                                {% else %}
                                    &nbsp;
                                {% endif %}
                            </div>
                            <div>
                                <p>
                                    <a href="{{ path('agency-view-by-slug', {slug: summary.agencySlug}) }}">{{ summary.agencyName }}</a><br>
                                    Average rating: {{ summary.meanRating }} stars from {{ summary.ratedCount }} review{% if summary.ratedCount > 1 %}s{% endif %}
                                </p>
                            </div>
                        </div>
                    {% else %}
                        <p>
                            There are currently no rated agencies in {{ locale.name }}.
                        </p>
                    {% endfor %}
                </div>
            </div>

            <hr>

            <div id="locale-view-root"></div>
        </div>
    </div>
{% endblock %}

{% block javascripts %}
    {{ encore_entry_script_tags('app') }}
    {{ encore_entry_script_tags('locale-view') }}
{% endblock %}